<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pesquisa</title>
    <link rel="stylesheet" href="../css/pesquisa.css">
    <link rel="shortcut icon" href="../imagens/Homem aranha topo.png" />
    <link rel="stylesheet" href="../css/navDash.css">

        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="../js/funcoes.js"></script>


</head>
<body>
  
  <div class="nav">
    <div class="saudacao">
      <b>Bem vindo</b> <b id="b_usuario"></b>
    </div>
    <a href="select.html">Card Figth</a>
    <a href="">Votação</a>
    <a href="../index.html">Voltar</a>
  </div>


    <div class="conteudo">
      <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Dolor deserunt iusto odit? Itaque doloribus at quis obcaecati, voluptate, doloremque officiis iusto maiores nisi ea voluptatem ullam possimus vero enim amet!</p>

      <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Dolor deserunt iusto odit? Itaque doloribus at quis obcaecati, voluptate, doloremque officiis iusto maiores nisi ea voluptatem ullam possimus vero enim amet!</p> <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Dolor deserunt iusto odit? Itaque doloribus at quis obcaecati, voluptate, doloremque officiis iusto maiores nisi ea voluptatem ullam possimus vero enim amet!</p>
    </div>  

 

  <div class="grafico">          
    <div >

      <div class="div_traje">
        <button onclick="votar_uniforme()">Votar no Uniforme</button>
        
        
     <select id="sel_traje">

      <option value="0">--Selecionar Traje--</option>
    
    </select>
       
      </div>

        <canvas id="canvas_traje" style="height:80px; width:150px" ></canvas>
    </div>

    
    
    <div>

      <div class="div_persona">
        <button onclick="votar_heroi()">Votar no personagem</button>

        <select id="sel_heroi">

          <option value="0">--Selecionar Personagem--</option>
    
        </select>  
      </div>

      
  
      <canvas id="canvas_personagem" style="height:80px; width:150px" ></canvas>
  </div>

  <div id="div_aguardar" class="loading-div">
  </div>    

    </div>

    <footer class="fundo">

      <p>Feito por Roberto Turbiani Jr /2023</p>

  </footer>
    

</body>
</html>
<script>

b_usuario.innerHTML = sessionStorage.NOME_USUARIO;


    var traje = document.getElementById('canvas_traje');
    var persona = document.getElementById('canvas_personagem');

    var trajeVar = sel_traje.value;
    var trajeVar = sel_heroi.value;


    


    function votos() {
      aguardar();
   
    }
    
  uniforme = new Chart(traje,{
        type: 'line',
        data: {
          labels: ['Tradicional', '2099', 'Noir', 'Traje-Venom', 'Aranha de ferro'],
          datasets: [{
            label: 'Traje',
            data: [],
            borderColor: 'dodgerblue',
            backgroundColor: 'crimson',
            borderWidth: 1,},
    
          ]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });


  personagem =  new Chart(persona,{
        type: 'bar',
        data: {
          labels: ['Venom', 'Homem-Aranha', 'Miles Morales', 'Mulher-Aranha', 'Gato-Aranha','Gwen-Aranha'],
          datasets: [{
            label: 'personagens' , 
            data: [],
            borderColor: 'dodgerblue',
            backgroundColor: 'crimson',
            borderWidth: 1,},
    
          ]
        },
        options: { 
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });

    function votar_uniforme() {


    uniforme.data.labels[0];
    uniforme.data.labels[1];
    uniforme.data.datasets[0].backgroundColor[0] = '#ce3600';
    uniforme.data.datasets[0].backgroundColor[0] = '#0098ce';
    uniforme.update();

    console.log('oi')
    function votos() {
    fetch("/votacao/votos", {
        method: "GET",
        headers: {
            "Content-type": "application/json"
        }
    }).then(async function (resposta) {
        const vetor = await resposta.json()
        for (let i = 0; i < vetor.length; i++) {
            const element = vetor[i];
            var newOption = document.createElement("option")       
            newOption.addEventListener('click', function() {
                suaFuncao(element)
            })
          
        }
        
    })
    return false;
}


      }

    function votar_heroi() {

    
      if (votospersonagem == 'Venom') {
        
        personagem.data.datasets[0].data[0] = votos1 ++;
      } else if (votospersonagem == 'Homem-Aranha') {
        
        personagem.data.datasets[0].data[1] = votos2 ++;
      } else if (votospersonagem == 'Miles Morales') {
        
        personagem.data.datasets[0].data[2] = votos3 ++;
      } else if (votospersonagem == 'Mulher Aranha') {
        
        personagem.data.datasets[0].data[3] = votos4 ++;
      } else if (votospersonagem == 'Gato-Aranha') {
        
        personagem.data.datasets[0].data[4] = votos5 ++;
      } else if (votospersonagem == 'Gwen-Aranha') {
        
        personagem.data.datasets[0].data[5] = votos6 ++;
      }

    personagem.data.labels[0];
    personagem.data.labels[1] ;
    personagem.data.datasets[0].backgroundColor[0] = '#ce3600';
    personagem.data.datasets[0].backgroundColor[1] = '#0098ce';
    personagem.update();

      }


      function suaFuncao(params) {
    sel_traje.innerHTML =(params.nome)
}

window.onload = () => {
    votos()
}
  
    </script>
